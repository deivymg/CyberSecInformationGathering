#!/bin/bash
find /path/to/folder/where/documents/located/ -type f -name "*.txt" -exec awk '/LISTEN/ {print substr(FILENAME, match(FILENAME, /[^\/]+$/)) "         ", $4 "         " $5 }' {} \; | sort -u | grep -v '127.0.0.1' | sed 's/ :::\*//' | sed 's/         0.0.0.0:\*//' | grep -v "ACC" | grep -v "::1:" | awk '{if ($3 != "") {$2=$4=""; print $0} else {print $1  "  " $2}}' | grep -v "\[\:\:1\]" | sed -E 's/[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+/IPv4/g' | sed 's/:::/IPv6:/g' | sed 's/\[::\]/IPv6:/g'| sed 's/\[::\]/IPv6/g' | sed 's/\*/Both/g'| sed 's/:/  /g' | awk '{a[$1" "$2]=a[$1" "$2]","$3}END{for(i in a) print i,a[i]}' | sort 
